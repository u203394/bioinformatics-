getwd()
library(readxl)
partos1 <- read_excel("C:/Users/Lenovo/Downloads/partos1.xlsx")
View(partos1)
View(partos1)
library(readxl)
partos1 <- read_excel("C:/Users/Lenovo/Downloads/partos1.xlsx")
View(partos1)
partos1 <- read_excel("C:/YOUR_PATH/partos1.xlsx")
load("~/BIOESTADÍSTICA/R/.RData")
library(readxl)
partos1 <- read_excel("BIOESTAD�\215STICA/R/partos1.xlsx")
View(partos1)
library(readxl)
partos1 <- read_excel("BIOESTADISTICA/R/partos1.xlsx")
View(partos1)
partos1 <- read_excel("BIOESTADISTICA/R/partos1.xlsx")
summary(partos1)
summary(partos1$PESNADO)
summary(partos1$GESTACIO)
partos1$GESTACIO <- factor(partos1$GESTACIO)
levels(partos1$GESTACIO)
levels(partos1$GESTACIO) <- c(NA, "A terme", "Gestacio prolonga", "Gestacio prolonga",
"Prematur")
noupes <- partos$PESNADO
noupes[noupes < 300] <- NA
hist(noupes)
hist(noupes,50)
boxplot(noupes)
boxplot(noupes, col="red")
nouedat <- split(partos1$EDATMARE, partos1$TRIMESTR)
boxplot(nouedat)
partos1 <- read_excel("BIOESTADISTICA/R/partos1.xlsx")
summary(partos1)
summary(partos1$PESNADO)
summary(partos1$GESTACIO)
partos1$GESTACIO <- factor(partos1$GESTACIO)
levels(partos1$GESTACIO)
levels(partos1$GESTACIO) <- c(NA, "A terme", "Gestacio prolonga", "Gestacio prolonga",
"Prematur")
noupes <- partos1$PESNADO
noupes[noupes < 300] <- NA
hist(noupes)
hist(noupes,50)
boxplot(noupes)
boxplot(noupes, col="red")
nouedat <- split(partos1$EDATMARE, partos1$TRIMESTR)
boxplot(nouedat)
boxplot(noupes, col="red")
summary(partos1$GESTACIO)
boxplot(nouedat, color ="light blue")
boxplot(nouedat, color ="blue")
hist(nouedat)
boxplot(nouedat, color ="blue")
partos1 <- read_excel("BIOESTADISTICA/R/partos1.xlsx")
summary(partos1)
summary(partos1$PESNADO)
summary(partos1$GESTACIO)
partos1$GESTACIO <- factor(partos1$GESTACIO)
levels(partos1$GESTACIO)
levels(partos1$GESTACIO) <- c(NA, "A terme", "Gestacio prolonga", "Gestacio prolonga",
"Prematur")
summary(partos1$GESTACIO)
noupes <- partos1$PESNADO
noupes[noupes < 300] <- NA
hist(noupes)
hist(noupes,50)
boxplot(noupes)
boxplot(noupes, col="red")
nouedat <- split(partos1$EDATMARE, partos1$TRIMESTR)
boxplot(nouedat, color ="blue")
summary(noupes)
summary(partos1$GESTACIO)
summary(partos1$PESNADO)
sd(noupes)
summary(nouedat)
summary(partos1$EDATMARE)
library(readxl)
PROB5 <- read_excel("BIOESTADISTICA/R/PRACTICA 8/PROB5.xlsx")
View(PROB5)
#Como son mas de 2 grupos hacemos ANOVA
data.anova <- aov (cuantitativa~cualitativa,PROB5)
summary (data.anova)
##Problema 5
#Como son mas de 2 grupos hacemos ANOVA
data.anova <- aov (Cuantitativa~Cualitativa,PROB5)
summary (data.anova)
boxplot(Cuantitativa~Cualitativa, PROB5)
View(PROB5)
load("~/BIOESTADISTICA/R/PRACTICA 8/.RData")
rm(data.anova, nouedat, partos1, PRO)
rm(data.anova, nouedat, partos1, PROB5)
rm(noupes)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de sch i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (sch, nosch) {
mean_nosch <- mean(noshc)
sd_nosch <- sd(nosch)
n_nosch <- length(nosch)
mean_sch <- mean(shc)
sd_sch <- sd(sch)
n_sch <- length(sch)
t <- (mean_sch - mean_nosch) / sqrt((sd_sch^2 / n_sch) + (sd_nosch^2 / n_nosch))
}
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI
BMI_sch <- Schizophrenia$BMI
BMI_healthy <- Healthy$BMI
function1(BMI_sch, BMI_healthy)
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_healthy <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_healthy)
View(Healthy)
View(Schizophrenia)
View(df2)
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI
BMI_sch <- c(Schizophrenia$BMI)
BMI_healthy <- c(Healthy$BMI)
function1(BMI_sch, BMI_healthy)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance
abund_sch <- c(Schizophrenia$Streptococcus_Abundance)
abund_healthy <- c(Healthy$Streptococcus_Abundance)
function1(abund_sch, abund_healthy)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de sch i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (sch, nosch) {
mean_nosch <- mean(nosch)
sd_nosch <- sd(nosch)
n_nosch <- length(nosch)
mean_sch <- mean(shc)
sd_sch <- sd(sch)
n_sch <- length(sch)
t <- (mean_sch - mean_nosch) / sqrt((sd_sch^2 / n_sch) + (sd_nosch^2 / n_nosch))
}
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI
BMI_sch <- c(Schizophrenia$BMI)
BMI_healthy <- c(Healthy$BMI)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance
abund_sch <- c(Schizophrenia$Streptococcus_Abundance)
abund_healthy <- c(Healthy$Streptococcus_Abundance)
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_healthy <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_healthy)
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_healthy <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_healthy)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de sch i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (sch, nosch) {
mean_nosch <- mean(nosch)
sd_nosch <- sd(nosch)
n_nosch <- length(nosch)
mean_sch <- mean(sch)
sd_sch <- sd(sch)
n_sch <- length(sch)
t <- (mean_sch - mean_nosch) / sqrt((sd_sch^2 / n_sch) + (sd_nosch^2 / n_nosch))
}
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI
BMI_sch <- c(Schizophrenia$BMI)
BMI_healthy <- c(Healthy$BMI)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_healthy <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_healthy)
BMI_sch <- Schizophrenia$BMI
BMI_nosch <- Healthy$BMI
function1(BMI_sch, BMI_nosch)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar sch amb sans
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_nosch <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_nosch)
rm(abund_healthy, BMI_healthy)
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI i fem una funció per comparar sch amb sans
BMI_sch <- Schizophrenia$BMI
BMI_healthy <- Healthy$BMI
function1(BMI_sch, BMI_healthy)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar sch amb sans
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_healthy <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_healthy)
rm(BMI_nosch, abund_nosch)
View(function1)
View(function1)
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI i fem una funció per comparar sch amb sans
BMI_sch <- Schizophrenia$BMI
BMI_nosch <- Healthy$BMI
function1(BMI_sch, BMI_nosch)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar sch amb sans
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_nosch <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_nosch)
rm(abund_healthy, BMI_healthy)
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI i fem una funció per comparar sch amb sans
BMI_sch <- Schizophrenia$BMI
BMI_nosch <- Healthy$BMI
function1(BMI_sch, BMI_nosch)
t_BMI <- function1(BMI_sch, BMI_nosch)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar sch amb sans
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_nosch <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_nosch)
t_abund <- function1(abund_sch, abund_nosch)
t_BMI <- function1(BMI_sch, BMI_nosch)
mean_sch
mean(Schizophrenia)
mean(sch)
mean_sch <- mean(sch)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de sch i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (sch, nosch) {
mean_nosch <- mean(nosch)
sd_nosch <- sd(nosch)
n_nosch <- length(nosch)
mean_sch <- mean(sch)
sd_sch <- sd(sch)
n_sch <- length(sch)
t <- (mean_sch - mean_nosch) / sqrt((sd_sch^2 / n_sch) + (sd_nosch^2 / n_nosch))
}
#Do patients with schizophrenia have a different BMI from healthy controls?
##Extraiem els valors de la columna BMI i fem una funció per comparar sch amb sans
BMI_sch <- Schizophrenia$BMI
BMI_nosch <- Healthy$BMI
function1(BMI_sch, BMI_nosch)
t_BMI <- function1(BMI_sch, BMI_nosch)
##El resultat que dona (1,942... ens indica que la mitjana de BMI en schizophrenia és major)
#Do patients with schizophrenia have a different Streptococcus abundance from healthy controls?
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar sch amb sans
abund_sch <- Schizophrenia$Streptococcus_Abundance
abund_nosch <- Healthy$Streptococcus_Abundance
function1(abund_sch, abund_nosch)
t_abund <- function1(abund_sch, abund_nosch)
mean_nosch <- mean(nosch)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de Schizophrenia i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="Schizophreniaizophrenia"
Schizophreniaizophrenia <- df2[df2$Group=="Schizophreniaizophrenia",]
head(Schizophreniaizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (Schizophreniaizophrenia, Healthy) {
mean_Healthy <- mean(Healthy)
sd_Healthy <- sd(Healthy)
n_Healthy <- length(Healthy)
mean_Schizophrenia <- mean(Schizophrenia)
sd_Schizophrenia <- sd(Schizophrenia)
n_Schizophrenia <- length(Schizophrenia)
t <- (mean_Schizophrenia - mean_Healthy) / sqrt((sd_Schizophrenia^2 / n_Schizophrenia) + (sd_Healthy^2 / n_Healthy))
}
View(Schizophreniaizophrenia)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de Schizophrenia i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="Schizophrenia"
Schizophrenia <- df2[df2$Group=="Schizophrenia",]
head(Schizophreniaizophrenia)
rm(Schizophreniaizophrenia)
rm(abund_nosch, abund_sch, BMI_nosch, BMI_sch)
function1 <- function (Schizophrenia, Healthy) {
mean_Healthy <- mean(Healthy)
sd_Healthy <- sd(Healthy)
n_Healthy <- length(Healthy)
mean_Schizophrenia <- mean(Schizophrenia)
sd_Schizophrenia <- sd(Schizophrenia)
n_Schizophrenia <- length(Schizophrenia)
t <- (mean_Schizophrenia - mean_Healthy) / sqrt((sd_Schizophrenia^2 / n_Schizophrenia) + (sd_Healthy^2 / n_Healthy))
}
View(function1)
mean(Healthy)
mean_Healthy
return(t)
t
t_value <- (mean_Schizophrenia - mean_Healthy) / sqrt((sd_Schizophrenia^2 / n_Schizophrenia) + (sd_Healthy^2 / n_Healthy))
mean_Schizophrenia <- mean(Schizophrenia)
mean_Healthy <- mean(Healthy)
View(Schizophrenia)
Schizophrenia <- df2[df2$Group=="Schizophrenia",]
Schizophrenia <- df2[df2$Group=="Schizophrenia",]
View(Schizophrenia)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Separem el banc de dades de Schizophrenia i de healthy. Ens torna un vector lògic de True o False
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="Schizophrenia"
Schizophrenia <- df2[df2$Group=="Schizophrenia",]
head(Schizophreniaizophrenia)
b true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="Schizophrenia",]
head(Schizophreniaizophrenia)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophreni)
mean_Schizophrenia <- mean(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (Schizophrenia, Healthy) {
mean_Healthy <- mean(healthy)
sd_Healthy <- sd(healthy)
n_Healthy <- length(healthy)
mean_Schizophrenia <- mean(schizophrenia)
sd_Schizophrenia <- sd(schizophrenia)
n_Schizophrenia <- length(schizophrenia)
t_value <- (mean_schizophrenia - mean_healthy) / sqrt((sd_schizophrenia^2 / n_schizophrenia) + (sd_healthy^2 / n_healthy))
}
head(Healthy)
head(Schizophrenia)
rm(mean_Healthy, mean_Schizophrenia)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (Schizophrenia, Healthy) {
mean_Healthy <- mean(healthy)
sd_Healthy <- sd(healthy)
n_Healthy <- length(healthy)
mean_Schizophrenia <- mean(schizophrenia)
sd_Schizophrenia <- sd(schizophrenia)
n_Schizophrenia <- length(schizophrenia)
t_value <- (mean_schizophrenia - mean_healthy) / sqrt((sd_schizophrenia^2 / n_schizophrenia) + (sd_healthy^2 / n_healthy))
}
mean_Healthy <- mean(healthy)
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (Schizophrenia, Healthy) {
mean_Healthy <- mean(healthy)
sd_Healthy <- sd(healthy)
n_Healthy <- length(healthy)
mean_Schizophrenia <- mean(schizophrenia)
sd_Schizophrenia <- sd(schizophrenia)
n_Schizophrenia <- length(schizophrenia)
t_value <- (mean_schizophrenia - mean_healthy) / sqrt((sd_schizophrenia^2 / n_schizophrenia) + (sd_healthy^2 / n_healthy))
}
#Per la fòrmula del t test necessitem mean, standard deviation, i sample size pel grup amb esquizofrènia i sense esquizofrènia. Hem de tenir en compte la fòrmula per una two sample t-test
function1 <- function (Schizophrenia, Healthy)
mean_Healthy <- mean(healthy)
sd_Healthy <- sd(healthy)
##Extraiem els valors de la columna BMI
BMI_Schizophrenia <- Schizophreniaizophrenia$BMI
##Extraiem els valors de la columna BMI
BMI_Schizophrenia <- Schizophrenia$BMI
BMI_Healthy <- Healthy$BMI
##Extraiem els valors de la columna Streptococcus abundance i fem una funció per comparar Schizophrenia amb sans
abund_Schizophrenia <- Schizophreniaizophrenia$Streptococcus_Abundance
abund_Healthy <- Healthy$Streptococcus_Abundance
#Calculem degrees of freedom (df)
df <- ((sd_Healthy^2 / n_Healthy^2 + sd_Schizophrenia^2 / n_Schizophrenia)^2) / (((sd_Healthy^2 / n_Healthy)^2 / (n_Healthy - 1)) + (( sd_Schizophrenia^2 / n_Schizophrenia)^2 / (n_Schizophrenia - 1)))
#Asumim un nivell de confiança de 95%, per tant alfa serà 0,005
alpha <- 0.05
t_critical <- qt(1 - alpha/2, df)
View(Healthy)
View(Schizophrenia)
num_Healthy <- sum (df2$Group == "schizophrenia")
rm(num_Healthy)
num_Healthy <- sum (df2$Group == "healthy")
num_Schizophrenia <- sum(df2$Group == "schizophrenia")
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
mean_Healthy <- mean(healthy)
df2 <- read.table(file = "~/BIOINFORMATICA/P2/Zhu_2020.txt",header = T, sep = "\t",row.names = 1)
is.data.frame(df2)
df2 <- as.data.frame(df2)
#Amb true i false ens torna la localització, ara extrec totes les files de TRUE per crear banc de dades de healthy
df2$Group=="healthy"
Healthy <- df2[df2$Group=="healthy",]
head(Healthy)
df2$Group=="schizophrenia"
Schizophrenia <- df2[df2$Group=="schizophrenia",]
head(Schizophrenia)
mean_Healthy <- mean(healthy)
mean_Healthy <- mean(Healthy)
meanBMI_Healthy <- mean(Healthy$BMI)
rm(mean_Healthy)
sdBMI_Healthy <- sd(Healthy)
nBMI_Healthy <- length(Healthy)
sdBMI_Healthy <- sd(Healthy$BMI)
nBMI_Healthy <- length(Healthy$BMI)
meanBMI_Schizophrenia <- mean(Schizophrenia$BMI)
sdBMI_Schizophrenia <- sd(Schizophrenia$BMI)
nBMI_Schizophrenia <- length(Schizophrenia$BMI)
tBMI_value <- (meanBMI_schizophrenia - meanBMI_healthy) / sqrt((sdBMI_schizophrenia^2 / nBMI_schizophrenia) + (sdBMI_healthy^2 / nBMI_healthy))
tBMI_value <- (meanBMI_Schizophrenia - meanBMI_Healthy) / sqrt((sdBMI_Schizophrenia^2 / nBMI_Schizophrenia) + (sdBMI_Healthy^2 / nBMI_Healthy))
tBMI_value <- (meanBMI_Healthy - meanBMI_Schizophrenia) / sqrt((sdBMI_Schizophrenia^2 / nBMI_Schizophrenia) + (sdBMI_Healthy^2 / nBMI_Healthy))
meanAbund_Healthy <- mean(Healthy$Streptococcus_Abundance)
sdAbund_Healthy <- sd(Healthy$Streptococcus_Abundance)
nAbund_Healthy <- length(Healthy$Streptococcus_Abundance)
meanAbund_Schizophrenia <- mean(Schizophrenia$Streptococcus_Abundance)
sdAbund_Schizophrenia <- sd(Schizophrenia$Streptococcus_Abundance)
nAbund_Schizophrenia <- length(Schizophrenia$Streptococcus_Abundance)
tAbund_value <- (meanAbund_Healthy - meanAbund_Schizophrenia) / sqrt((sdAbund_Schizophrenia^2 / nAbund_Schizophrenia) + (sdAbund_Healthy^2 / nAbund_Healthy))
tAbund_value <- (meanAbund_Schizophrenia - meanAbund_Healthy) / sqrt((sdAbund_Schizophrenia^2 / nAbund_Schizophrenia) + (sdAbund_Healthy^2 / nAbund_Healthy))
#Calculem degrees of freedom (df)
df <- ((sdBMI_Healthy^2 / nBMI_Healthy^2 + sdBMI_Schizophrenia^2 / nBMI_Schizophrenia)^2) / (((sdBMI_Healthy^2 / nBMI_Healthy)^2 / (nBMI_Healthy - 1)) + (( sdBMI_Schizophrenia^2 / nBMI_Schizophrenia)^2 / (nBMI_Schizophrenia - 1)))
#Calculem degrees of freedom (df)
dfBMI <- ((sdBMI_Healthy^2 / nBMI_Healthy^2 + sdBMI_Schizophrenia^2 / nBMI_Schizophrenia)^2) / (((sdBMI_Healthy^2 / nBMI_Healthy)^2 / (nBMI_Healthy - 1)) + (( sdBMI_Schizophrenia^2 / nBMI_Schizophrenia)^2 / (nBMI_Schizophrenia - 1)))
dfAbund <- ((sdAbund_Healthy^2 / nAbund_Healthy^2 + sdAbund_Schizophrenia^2 / nAbund_Schizophrenia)^2) / (((sdAbund_Healthy^2 / nAbund_Healthy)^2 / (nAbund_Healthy - 1)) + (( sdAbund_Schizophrenia^2 / nAbund_Schizophrenia)^2 / (nAbund_Schizophrenia - 1)))
rm(df)
#Calcular el p-value para un test de dos colas
p_valueBMI <- 2 * (1 - pt(abs(tBMI_value), dfBMI))
##P value més petit que 0,05 per tant si hi ha diferencia significativa
p_valueAbund <- 2 * (1 - pt(abs(tAbund_value), dfAbund))
# Mostrar el p-value
p_valueAbund
p_valueBMI
setwd("C:/Users/Lenovo/bioinformatics-/PROJECT_files")
setwd("C:/Users/Lenovo/bioinformatics-")
